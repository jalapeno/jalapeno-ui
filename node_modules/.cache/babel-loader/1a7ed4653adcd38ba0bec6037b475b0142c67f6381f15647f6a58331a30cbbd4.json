{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar layout_1 = require(\"./layout\");\nvar D3StyleLayoutAdaptor = function (_super) {\n  __extends(D3StyleLayoutAdaptor, _super);\n  function D3StyleLayoutAdaptor() {\n    var _this = _super.call(this) || this;\n    _this.event = d3.dispatch(layout_1.EventType[layout_1.EventType.start], layout_1.EventType[layout_1.EventType.tick], layout_1.EventType[layout_1.EventType.end]);\n    var d3layout = _this;\n    var drag;\n    _this.drag = function () {\n      if (!drag) {\n        var drag = d3.behavior.drag().origin(layout_1.Layout.dragOrigin).on(\"dragstart.d3adaptor\", layout_1.Layout.dragStart).on(\"drag.d3adaptor\", function (d) {\n          layout_1.Layout.drag(d, d3.event);\n          d3layout.resume();\n        }).on(\"dragend.d3adaptor\", layout_1.Layout.dragEnd);\n      }\n      if (!arguments.length) return drag;\n      this.call(drag);\n    };\n    return _this;\n  }\n  D3StyleLayoutAdaptor.prototype.trigger = function (e) {\n    var d3event = {\n      type: layout_1.EventType[e.type],\n      alpha: e.alpha,\n      stress: e.stress\n    };\n    this.event[d3event.type](d3event);\n  };\n  D3StyleLayoutAdaptor.prototype.kick = function () {\n    var _this = this;\n    d3.timer(function () {\n      return _super.prototype.tick.call(_this);\n    });\n  };\n  D3StyleLayoutAdaptor.prototype.on = function (eventType, listener) {\n    if (typeof eventType === 'string') {\n      this.event.on(eventType, listener);\n    } else {\n      this.event.on(layout_1.EventType[eventType], listener);\n    }\n    return this;\n  };\n  return D3StyleLayoutAdaptor;\n}(layout_1.Layout);\nexports.D3StyleLayoutAdaptor = D3StyleLayoutAdaptor;\nfunction d3adaptor() {\n  return new D3StyleLayoutAdaptor();\n}\nexports.d3adaptor = d3adaptor;","map":{"version":3,"names":["layout_1","require","D3StyleLayoutAdaptor","_super","__extends","_this","call","event","d3","dispatch","EventType","start","tick","end","d3layout","drag","behavior","origin","Layout","dragOrigin","on","dragStart","d","resume","dragEnd","arguments","length","prototype","trigger","e","d3event","type","alpha","stress","kick","timer","eventType","listener","exports","d3adaptor"],"sources":["/Users/brucemcdougall/go/jalapeno-github/jalapeno-ui/node_modules/webcola/WebCola/src/d3v3adaptor.ts"],"sourcesContent":["////<reference path=\"../extern/d3v3.d.ts\"/>\r\n////commented out the reference, because the path ended up in the typings, which\r\n////makes it impossible import in other projects.\r\ndeclare const d3;\r\n\r\n\r\nimport {Layout, EventType, Event} from './layout';\r\nimport {ID3StyleLayoutAdaptor} from './d3adaptor'\r\n\r\n    export class D3StyleLayoutAdaptor extends Layout implements ID3StyleLayoutAdaptor {\r\n        event = d3.dispatch(EventType[EventType.start], EventType[EventType.tick], EventType[EventType.end]);\r\n\r\n        trigger(e: Event) {\r\n            var d3event = { type: EventType[e.type], alpha: e.alpha, stress: e.stress };\r\n            this.event[d3event.type](d3event); // via d3 dispatcher, e.g. event.start(e);\r\n        }\r\n\r\n        // iterate layout using a d3.timer, which queues calls to tick repeatedly until tick returns true\r\n        kick() {\r\n            d3.timer(() => super.tick());\r\n        }\r\n\r\n        // a function to allow for dragging of nodes\r\n        drag: () => any;\r\n\r\n        constructor() {\r\n            super();\r\n            // bit of trickyness remapping 'this' so we can reference it in the function body.\r\n            var d3layout = this;\r\n            var drag;\r\n            this.drag = function () {\r\n                if (!drag) {\r\n                    var drag = d3.behavior.drag()\r\n                        .origin(Layout.dragOrigin)\r\n                        .on(\"dragstart.d3adaptor\", Layout.dragStart)\r\n                        .on(\"drag.d3adaptor\", d => {\r\n                            Layout.drag(d, <any>d3.event);\r\n                            d3layout.resume(); // restart annealing\r\n                        })\r\n                        .on(\"dragend.d3adaptor\", Layout.dragEnd);\r\n                }\r\n\r\n                if (!arguments.length) return drag;\r\n\r\n                // this is the context of the function, i.e. the d3 selection\r\n                this//.on(\"mouseover.adaptor\", colaMouseover)\r\n                //.on(\"mouseout.adaptor\", colaMouseout)\r\n                    .call(drag);\r\n            }\r\n        }\r\n\r\n        // a function for binding to events on the adapter\r\n        on(eventType: EventType | string, listener: () => void): this {\r\n            if (typeof eventType === 'string') {\r\n                this.event.on(eventType, listener);\r\n            } else {\r\n                this.event.on(EventType[eventType], listener);\r\n            }\r\n            return this;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * provides an interface for use with d3:\r\n     * - uses the d3 event system to dispatch layout events such as:\r\n     *   o \"start\" (start layout process)\r\n     *   o \"tick\" (after each layout iteration)\r\n     *   o \"end\" (layout converged and complete).\r\n     * - uses the d3 timer to queue layout iterations.\r\n     * - sets up d3.behavior.drag to drag nodes\r\n     *   o use `node.call(<the returned instance of Layout>.drag)` to make nodes draggable\r\n     * returns an instance of the cola.Layout itself with which the user\r\n     * can interact directly.\r\n     */\r\n    export function d3adaptor(): D3StyleLayoutAdaptor {\r\n        return new D3StyleLayoutAdaptor();\r\n    }\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAMA,IAAAA,QAAA,GAAAC,OAAA;AAGI,IAAAC,oBAAA,aAAAC,MAAA;EAA0CC,SAAA,CAAAF,oBAAA,EAAAC,MAAA;EAgBtC,SAAAD,qBAAA;IAAA,IAAAG,KAAA,GACIF,MAAA,CAAAG,IAAA,MAAO;IAhBXD,KAAA,CAAAE,KAAK,GAAGC,EAAE,CAACC,QAAQ,CAACT,QAAA,CAAAU,SAAS,CAACV,QAAA,CAAAU,SAAS,CAACC,KAAK,CAAC,EAAEX,QAAA,CAAAU,SAAS,CAACV,QAAA,CAAAU,SAAS,CAACE,IAAI,CAAC,EAAEZ,QAAA,CAAAU,SAAS,CAACV,QAAA,CAAAU,SAAS,CAACG,GAAG,CAAC,CAAC;IAkBhG,IAAIC,QAAQ,GAAGT,KAAI;IACnB,IAAIU,IAAI;IACRV,KAAI,CAACU,IAAI,GAAG;MACR,IAAI,CAACA,IAAI,EAAE;QACP,IAAIA,IAAI,GAAGP,EAAE,CAACQ,QAAQ,CAACD,IAAI,EAAE,CACxBE,MAAM,CAACjB,QAAA,CAAAkB,MAAM,CAACC,UAAU,CAAC,CACzBC,EAAE,CAAC,qBAAqB,EAAEpB,QAAA,CAAAkB,MAAM,CAACG,SAAS,CAAC,CAC3CD,EAAE,CAAC,gBAAgB,EAAE,UAAAE,CAAC;UACnBtB,QAAA,CAAAkB,MAAM,CAACH,IAAI,CAACO,CAAC,EAAOd,EAAE,CAACD,KAAK,CAAC;UAC7BO,QAAQ,CAACS,MAAM,EAAE;QACrB,CAAC,CAAC,CACDH,EAAE,CAAC,mBAAmB,EAAEpB,QAAA,CAAAkB,MAAM,CAACM,OAAO,CAAC;;MAGhD,IAAI,CAACC,SAAS,CAACC,MAAM,EAAE,OAAOX,IAAI;MAGlC,IAAI,CAECT,IAAI,CAACS,IAAI,CAAC;IACnB,CAAC;;EACL;EArCAb,oBAAA,CAAAyB,SAAA,CAAAC,OAAO,GAAP,UAAQC,CAAQ;IACZ,IAAIC,OAAO,GAAG;MAAEC,IAAI,EAAE/B,QAAA,CAAAU,SAAS,CAACmB,CAAC,CAACE,IAAI,CAAC;MAAEC,KAAK,EAAEH,CAAC,CAACG,KAAK;MAAEC,MAAM,EAAEJ,CAAC,CAACI;IAAM,CAAE;IAC3E,IAAI,CAAC1B,KAAK,CAACuB,OAAO,CAACC,IAAI,CAAC,CAACD,OAAO,CAAC;EACrC,CAAC;EAGD5B,oBAAA,CAAAyB,SAAA,CAAAO,IAAI,GAAJ;IAAA,IAAA7B,KAAA;IACIG,EAAE,CAAC2B,KAAK,CAAC;MAAM,OAAAhC,MAAA,CAAAwB,SAAA,CAAMf,IAAI,CAAAN,IAAA,CAAAD,KAAA,CAAE;IAAZ,CAAY,CAAC;EAChC,CAAC;EAgCDH,oBAAA,CAAAyB,SAAA,CAAAP,EAAE,GAAF,UAAGgB,SAA6B,EAAEC,QAAoB;IAClD,IAAI,OAAOD,SAAS,KAAK,QAAQ,EAAE;MAC/B,IAAI,CAAC7B,KAAK,CAACa,EAAE,CAACgB,SAAS,EAAEC,QAAQ,CAAC;KACrC,MAAM;MACH,IAAI,CAAC9B,KAAK,CAACa,EAAE,CAACpB,QAAA,CAAAU,SAAS,CAAC0B,SAAS,CAAC,EAAEC,QAAQ,CAAC;;IAEjD,OAAO,IAAI;EACf,CAAC;EACL,OAAAnC,oBAAC;AAAD,CAAC,CAnDyCF,QAAA,CAAAkB,MAAM;AAAnCoB,OAAA,CAAApC,oBAAA,GAAAA,oBAAA;AAiEb,SAAgBqC,SAASA,CAAA;EACrB,OAAO,IAAIrC,oBAAoB,EAAE;AACrC;AAFAoC,OAAA,CAAAC,SAAA,GAAAA,SAAA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}